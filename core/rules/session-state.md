# Rule: ì„¸ì…˜ ìƒíƒœ ê´€ë¦¬ (Session State Management)

ë©€í‹° í„°ë¯¸ë„ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ ì—­í• ì´ ë™ì‹œì— ì‘ì—…í•  ë•Œì˜ ìƒíƒœ ê´€ë¦¬ ê·œì¹™.

---

## 1. ìƒíƒœ íŒŒì¼

### ìœ„ì¹˜
```
ai-dev-team/.ada-status.json
```

### ìŠ¤í‚¤ë§ˆ

```json
{
  "version": "1.0",
  "updatedAt": "ISO8601 timestamp",
  "currentPhase": "planning|architecture|development|review|qa|done",
  "activeSessions": [
    {
      "role": "ì—­í• ëª…",
      "tool": "claude|codex|gemini|copilot",
      "pid": "í”„ë¡œì„¸ìŠ¤ID (ì„ íƒ)",
      "startedAt": "ISO8601 timestamp",
      "status": "active|idle|waiting"
    }
  ],
  "pendingQuestions": [
    {
      "id": "Q001",
      "from": "ì—­í• ëª…",
      "to": "user|manager|ì—­í• ëª…",
      "question": "ì§ˆë¬¸ ë‚´ìš©",
      "options": ["ì˜µì…˜1", "ì˜µì…˜2"],
      "priority": "high|normal|low",
      "status": "waiting|answered|timeout",
      "createdAt": "ISO8601 timestamp",
      "answeredAt": "ISO8601 timestamp (ì„ íƒ)",
      "answer": "ì‘ë‹µ (ì„ íƒ)"
    }
  ],
  "taskProgress": {
    "T001": {
      "status": "READY|IN_DEV|IN_REVIEW|IN_QA|DONE",
      "assignee": "ì—­í• ëª…",
      "progress": 0-100,
      "lastUpdate": "ISO8601 timestamp"
    }
  },
  "notifications": [
    {
      "id": "N001",
      "type": "info|warning|error|question",
      "from": "ì—­í• ëª…",
      "message": "ì•Œë¦¼ ë‚´ìš©",
      "read": false,
      "createdAt": "ISO8601 timestamp"
    }
  ],
  "locks": {
    "íŒŒì¼ê²½ë¡œ": {
      "holder": "ì—­í• ëª…",
      "acquiredAt": "ISO8601 timestamp"
    }
  }
}
```

---

## 2. ì—­í• ë³„ ìƒíƒœ ì—…ë°ì´íŠ¸ ê·œì¹™

### ì„¸ì…˜ ì‹œì‘ ì‹œ
```
1. .ada-status.json ì½ê¸° (ì—†ìœ¼ë©´ ìƒì„±)
2. activeSessionsì— ìì‹  ì¶”ê°€
3. íŒŒì¼ ì €ì¥
```

### ì§ˆë¬¸ ë°œìƒ ì‹œ
```
1. pendingQuestionsì— ì§ˆë¬¸ ì¶”ê°€
2. status: "waiting"
3. notificationsì— ì•Œë¦¼ ì¶”ê°€
4. íŒŒì¼ ì €ì¥
5. CLIì— "[ì§ˆë¬¸ ë“±ë¡ë¨] Managerì—ê²Œ ì•Œë¦¼ ì „ì†¡" ì¶œë ¥
```

### ì‘ì—… ì§„í–‰ ì‹œ
```
1. taskProgress ì—…ë°ì´íŠ¸
2. progress ê°’ ê°±ì‹ 
3. íŒŒì¼ ì €ì¥
```

### ì„¸ì…˜ ì¢…ë£Œ ì‹œ
```
1. activeSessionsì—ì„œ ìì‹  ì œê±°
2. ë¯¸ì‘ë‹µ ì§ˆë¬¸ ì •ë¦¬
3. íŒŒì¼ ì €ì¥
```

---

## 3. Manager ëª¨ë‹ˆí„°ë§ ëª¨ë“œ

ManagerëŠ” ë‘ ê°€ì§€ ëª¨ë“œë¡œ ë™ì‘:

### ì¼ë°˜ ëª¨ë“œ
```
ê¸°ì¡´ ìŠ¤í”„ë¦°íŠ¸ ê´€ë¦¬ ê¸°ëŠ¥
```

### ëª¨ë‹ˆí„°ë§ ëª¨ë“œ (--watch)
```
1. .ada-status.json ì£¼ê¸°ì  ê°ì‹œ (2ì´ˆ ê°„ê²©)
2. ë³€ê²½ ê°ì§€ ì‹œ í™”ë©´ ì—…ë°ì´íŠ¸
3. pendingQuestions ë°œìƒ ì‹œ ì•Œë¦¼
4. ì—¬ê¸°ì„œ ì§ì ‘ ì‘ë‹µ ê°€ëŠ¥
```

---

## 4. íŒŒì¼ ì ê¸ˆ ê·œì¹™

### ì ê¸ˆì´ í•„ìš”í•œ íŒŒì¼
```
- current-sprint.md (ë™ì‹œ ìˆ˜ì • ë°©ì§€)
- backlog.md (Task ìƒíƒœ ë³€ê²½ ì‹œ)
```

### ì ê¸ˆ ì ˆì°¨
```
1. locksì— íŒŒì¼ ê²½ë¡œì™€ ì—­í•  ë“±ë¡
2. ì‘ì—… ìˆ˜í–‰
3. ì™„ë£Œ í›„ ì ê¸ˆ í•´ì œ
4. 30ì´ˆ ì´ìƒ ì ê¸ˆ ìœ ì§€ ì‹œ ê²½ê³ 
```

### ì¶©ëŒ ë°œìƒ ì‹œ
```
1. ì ê¸ˆ ë³´ìœ ì í™•ì¸
2. notificationsë¡œ ì•Œë¦¼
3. ëŒ€ê¸° ë˜ëŠ” Managerì—ê²Œ ì—ìŠ¤ì»¬ë ˆì´ì…˜
```

---

## 5. ì§ˆë¬¸/ì‘ë‹µ í”„ë¡œí† ì½œ

### ì§ˆë¬¸ ë“±ë¡ (ì—­í•  â†’ Manager)

```json
{
  "id": "Q001",
  "from": "developer",
  "to": "manager",
  "question": "Redis ìºì‹œë¥¼ ì ìš©í• ê¹Œìš”?",
  "options": ["y: ì ìš©", "n: ë¯¸ì ìš©"],
  "priority": "normal",
  "status": "waiting",
  "createdAt": "2024-01-15T10:30:00Z"
}
```

### ì‘ë‹µ (Manager â†’ ì—­í• )

```json
{
  "id": "Q001",
  "status": "answered",
  "answeredAt": "2024-01-15T10:32:00Z",
  "answer": "y"
}
```

### ì—­í• ì—ì„œ ì‘ë‹µ í™•ì¸

```
1. pendingQuestionsì—ì„œ ìì‹ ì˜ ì§ˆë¬¸ í™•ì¸
2. statusê°€ "answered"ë©´ answer ì½ê¸°
3. ì§ˆë¬¸ í•­ëª© ì‚­ì œ ë˜ëŠ” archivedë¡œ ì´ë™
4. ì‘ì—… ê³„ì† ì§„í–‰
```

---

## 6. ì•Œë¦¼ íƒ€ì…

| íƒ€ì… | ìš©ë„ | ì˜ˆì‹œ |
|------|------|------|
| info | ì •ë³´ ì „ë‹¬ | "Developerê°€ T001 ì‘ì—… ì‹œì‘" |
| warning | ì£¼ì˜ í•„ìš” | "íŒŒì¼ ì ê¸ˆ 30ì´ˆ ì´ˆê³¼" |
| error | ì˜¤ë¥˜ ë°œìƒ | "current-sprint.md ì¶©ëŒ" |
| question | ì‘ë‹µ í•„ìš” | "Architect ì§ˆë¬¸ ëŒ€ê¸° ì¤‘" |

---

## 7. CLI ì¶œë ¥ í˜•ì‹

### ë‹¤ë¥¸ ì„¸ì…˜ì— ì§ˆë¬¸ ì „ë‹¬ ì‹œ
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“¨ ì§ˆë¬¸ ë“±ë¡ë¨
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì§ˆë¬¸: Redis ìºì‹œë¥¼ ì ìš©í• ê¹Œìš”?
ì˜µì…˜: (y) ì ìš© / (n) ë¯¸ì ìš©

Manager ì„¸ì…˜ì—ì„œ ì‘ë‹µ ëŒ€ê¸° ì¤‘...
ë˜ëŠ” ì´ í„°ë¯¸ë„ì—ì„œ ì‘ë‹µ: (y/n): _
```

### Managerì—ì„œ ì§ˆë¬¸ ìˆ˜ì‹  ì‹œ
```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âš ï¸ ìƒˆ ì§ˆë¬¸ [Developer]
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Q001: Redis ìºì‹œë¥¼ ì ìš©í• ê¹Œìš”?
ì˜µì…˜: (y) ì ìš© / (n) ë¯¸ì ìš©

ì‘ë‹µ: _
```

---

## 8. ìƒíƒœ ì´ˆê¸°í™”

### ì „ì²´ ì´ˆê¸°í™”
```bash
ada reset --status
```

### ì¢€ë¹„ ì„¸ì…˜ ì •ë¦¬
```bash
ada status --clean
```

---

## 9. ì—ëŸ¬ ì²˜ë¦¬

### ìƒíƒœ íŒŒì¼ ì†ìƒ ì‹œ
```
1. .ada-status.json.bakì—ì„œ ë³µêµ¬ ì‹œë„
2. ì‹¤íŒ¨ ì‹œ ì´ˆê¸°í™”
3. ëª¨ë“  ì„¸ì…˜ì— ì•Œë¦¼
```

### ë„¤íŠ¸ì›Œí¬ íŒŒì¼ì‹œìŠ¤í…œ ì£¼ì˜
```
- NFS, SMB ë“±ì—ì„œëŠ” íŒŒì¼ ì ê¸ˆ ë¶ˆì•ˆì •
- ë¡œì»¬ íŒŒì¼ì‹œìŠ¤í…œ ê¶Œì¥
```
